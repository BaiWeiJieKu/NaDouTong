webpackJsonp([12],{"5j+y":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aozt"),n=a.n(r),i={name:"optionsformationSearch",data:function(){return{formItem:{numberplate:"",departure:"",start:"",destination:"",goodsname:"",end:new Date,page:1},formRule:{},data:[]}},props:{ordernumbers:Array,goodsnames:Array},methods:{handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?t.$emit("handleOptionsSearch",t.formItem):t.$Message.error("请填写必填字段")})},startChange:function(e){var t=new Date(this.formItem.end);new Date(e)>t&&(this.formItem.start="")},endChange:function(e){var t=new Date(this.formItem.start);new Date(e)<t&&(this.formItem.end="")}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("Form",{ref:"formItem",attrs:{model:e.formItem,rules:e.formRule,"label-position":"left","label-width":60,inline:""}},[a("FormItem",{attrs:{label:"订单号",prop:"numberplate"}},[a("Select",{attrs:{filterable:""},model:{value:e.formItem.ordernumbers,callback:function(t){e.$set(e.formItem,"ordernumbers",t)},expression:"formItem.ordernumbers"}},e._l(e.ordernumbers,function(t,r){return a("Option",{key:t.id,attrs:{value:t.ordernumber}},[e._v(e._s(t.ordernumber))])}))],1),e._v(" "),a("FormItem",{attrs:{label:"开始时间",prop:"start"}},[a("DatePicker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"请选择时间"},on:{"on-change":e.startChange},model:{value:e.formItem.start,callback:function(t){e.$set(e.formItem,"start",t)},expression:"formItem.start"}})],1),e._v(" "),a("FormItem",{attrs:{label:"~",prop:"end","label-width":30}},[a("DatePicker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"请选择时间"},on:{"on-change":e.endChange},model:{value:e.formItem.end,callback:function(t){e.$set(e.formItem,"end",t)},expression:"formItem.end"}})],1),e._v(" "),a("FormItem",{attrs:{label:"出发地",prop:"departure"}},[a("Input",{attrs:{placeholder:"出发地"},model:{value:e.formItem.departure,callback:function(t){e.$set(e.formItem,"departure",t)},expression:"formItem.departure"}})],1),e._v(" "),a("FormItem",{attrs:{label:"到达地",prop:"destination"}},[a("Input",{attrs:{placeholder:"到达地"},model:{value:e.formItem.destination,callback:function(t){e.$set(e.formItem,"destination",t)},expression:"formItem.destination"}})],1),e._v(" "),a("FormItem",{attrs:{label:"货物名称",prop:"goodsname"}},[a("Select",{attrs:{filterable:""},model:{value:e.formItem.goodsname,callback:function(t){e.$set(e.formItem,"goodsname",t)},expression:"formItem.goodsname"}},e._l(e.goodsnames,function(t,r){return a("Option",{key:r,attrs:{value:t.goodsname}},[e._v(e._s(t.goodsname))])}))],1),e._v(" "),a("FormItem",{staticStyle:{"margin-left":"-60px"}},[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("formItem")}}},[e._v("查询")])],1)],1)],1)},staticRenderFns:[]};var s={name:"dispatchManagement",data:function(){var e=this;return{ruleValidate:{ordermoney:[{required:!0,validator:function(e,t,a){""===t?a(new Error("请输入派单金额")):""!=t&&a()},trigger:"blur"}],numberplate:[{required:!0,validator:function(e,t,a){t?""==t?a(new Error("请选择派单司机")):""!=t&&a():a(new Error("请选择派单司机"))},trigger:"change"}],operating:[{required:!0,message:"请输入操作人",trigger:"blur"}],oncetraffic:[{required:!0,validator:function(e,t,a){""===t?a(new Error("请输入派量")):""!=t&&a()}}],time:[{required:!0,validator:function(e,t,a){""===t?a(new Error("请选择派单时间")):""!=t&&a()}}]},showAdd:!1,deleteStatus:!1,query:{},datas:[],href:"",ordernumbers:[],numberplates:[],goodsnames:[],dataId:"",dataTotal:0,searchItems:{},loading:!1,status:!1,temp:{ordermoney:0,numberplate:"",cid:"",oncetraffic:0,operating:"",createtime:""},detailsDatas:[],detailsTitles:[{title:"序号",key:"sequence",width:70,fixed:"left",align:"center",render:function(e,t){return e("div",[e("span",{props:{type:"primary",size:"small"},style:{marginRight:"5px"}},t.index+1)])}},{title:"派单司机",key:"ordernumber",align:"center",width:130},{title:"车牌号",key:"ordernumber",align:"center",width:180},{title:"派单运量",key:"ordernumber",align:"center",width:110},{title:"派单出发时间",key:"ordernumber",align:"center",width:180},{title:"派单到达时间",key:"ordernumber",align:"center",width:180},{title:"运单状态",key:"ordernumber",align:"center",width:130},{title:"派单号",key:"ordernumber",align:"center",width:180,fixed:"right"},{title:"操作人",key:"ordernumber",align:"center",width:130}],titles:[{type:"selection",align:"center",width:50,fixed:"left"},{title:"序号",key:"sequence",width:70,fixed:"left",align:"center",render:function(e,t){return e("div",[e("span",{props:{type:"primary",size:"small"},style:{marginRight:"5px"}},t.index+1)])}},{title:"订单号",key:"ordernumber",align:"center",width:220,fixed:"left"},{title:"承运方",key:"carrier",align:"center",width:130},{title:"发送方",key:"dispatchedparty",align:"center",width:130},{title:"起运地",key:"departure",align:"center",width:210},{title:"发货人",key:"sendername",align:"center",width:130},{title:"联系方式",key:"sendertel",align:"center",width:180},{title:"到达地",key:"destination",align:"center",width:180},{title:"收货人",key:"receivername",align:"center",width:180},{title:"联系方式",key:"receivertel",align:"center",width:180},{title:"总量",key:"totaltraffic",align:"center",width:180},{title:"余量",key:"remain",align:"center",width:180},{title:"体积",key:"volume",align:"center",width:180},{title:"货物名称",key:"gid",align:"center",width:180,render:function(t,a){return t("div",e.goodsnames.find(function(e){return e.id==a.row.gid}).goodsname)}},{title:"托运合同",key:"contractrote",align:"center",width:180,render:function(t,a){if(""==a.row.contractrote){var r=e;return t("Upload",{props:{action:"/uploadOrderManagement?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){r.handleSearch(r.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])}var n=e;return t("div",[t("a",{attrs:{href:a.row.contractrote,target:"_blank"}},"查看图片"),t("Upload",{style:{display:"inline"},props:{action:"/uploadOrderManagement?id="+a.row.id,accept:"image/*",onSuccess:function(){n.handleSearch(n.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])])}},{title:"备注",key:"mark",align:"center",tooltip:!0,width:220},{title:"编辑",key:"id",width:100,fixed:"right",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.dataIndex=a.index,e.show(a.row)}}},"派单")])}}]}},components:{dispatchManagementSearch:a("C7Lr")(i,o,!1,function(e){a("SVfk")},"data-v-1c1f5a12",null).exports,dispatchManagementTable:a("8Wy1").a},methods:{handleSearch:function(e){this.query=e,this.loading=!0,n.a.get("/api/dispatchManagement.json",{params:e}).then(this.getOptionsSucc)},getOptionsSucc:function(e){this.loading=!1,(e=e.data).ret&&e.data&&(this.datas=e.data.data,this.dataTotal=e.data.total)},deleteSucc:function(){this.handleSearch(this.query)},pageChange:function(e){this.query.page=e,this.handleSearch(this.query)},handleInsert:function(){this.clearModel(),this.status=!0,this.href="/api/insertDispatchManagement.json"},right:function(){var e=this;this.$refs.temp.validate(function(t){if(t){e.loading=!0;var a=e,r=e.numberplates.find(function(e){return e.id==a.temp.numberplate});e.temp.cid=r.cid,e.loading=!0,n.a.get(e.href,{params:e.temp}).then(e.insertSucc)}})},cancel:function(){this.$refs.temp.resetFields(),this.status=!1},otherCancel:function(e){e||this.cancel()},insertSucc:function(e){e=e.data,this.loading=!1,e.ret&&this.handleSearch(this.query),this.status=!1},clearModel:function(){for(var e in this.temp)this.temp[e]=""},handleDelete:function(e){n.a.get("/api/deleteDispatchManagement.json",{params:{ids:this.dataId}}).then(this.handleDeleteSucc)},handleDeleteSucc:function(e){this.deleteStatus=!1,(e=e.data).ret?this.handleSearch(this.query):this.$Notice.error({desc:"删除失败",duration:0})},deleteAll:function(e){n.a.get("/api/deleteDispatchManagement.json",{params:{ids:e.toString()}}).then(this.handleDeleteSucc)},show:function(e){this.status=!0,this.temp.ordernumber=e.ordernumber,this.temp.ordermoney=e.ordermoney,this.temp.numberplate=e.numberplate,this.temp.oncetraffic=e.oncetraffic,this.temp.operating=e.operating,this.href="/api/updeteDispatchManagement.json"},guanli:function(){this.loading=!0,n.a.get("/api/guanli.json",{params:{id:this.dataId}}).then(this.guanliSucc)},guanliSucc:function(e){this.deleteStatus=!0,this.loading=!1,(e=e.data).ret&&(this.detailsDatas=e.data.data)},initPage:function(){n.a.get("/api/orderDispatch.json").then(this.initPageSucc),n.a.get("/api/optionsDriverManagementStatus.json").then(this.orderDriver)},orderDriver:function(e){(e=e.data).ret&&(this.numberplates=e.data)},initPageSucc:function(e){(e=e.data).ret&&(this.goodsnames=e.data.goodsnames,this.ordernumbers=e.data.ordernumbers)}},mounted:function(){this.initPage()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("dispatchManagementSearch",{attrs:{ordernumbers:e.ordernumbers,goodsnames:e.goodsnames},on:{handleOptionsSearch:e.handleSearch}}),e._v(" "),a("dispatchManagementTable",{attrs:{page:e.query.page,titles:e.titles,datas:e.datas,total:e.dataTotal,loading:e.loading,show:e.showAdd},on:{handleInsert:e.handleInsert,deleteAll:e.deleteAll,pageChange:e.pageChange}}),e._v(" "),a("Modal",{attrs:{"mask-closable":!1,"footer-hide":!0,"ok-text":"确定","cancel-text":"取消",width:"500",styles:{top:"20px"}},on:{"on-visible-change":e.otherCancel},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("Form",{ref:"temp",staticStyle:{"margin-top":"20px"},attrs:{rules:e.ruleValidate,model:e.temp,"label-width":100}},[a("FormItem",{attrs:{label:"派单金额",prop:"ordermoney"}},[a("InputNumber",{staticStyle:{width:"365px"},attrs:{max:1e7,min:0},model:{value:e.temp.ordermoney,callback:function(t){e.$set(e.temp,"ordermoney",t)},expression:"temp.ordermoney"}})],1),e._v(" "),a("FormItem",{attrs:{label:"派单司机",prop:"numberplate"}},[a("Select",{attrs:{filterable:""},model:{value:e.temp.numberplate,callback:function(t){e.$set(e.temp,"numberplate",t)},expression:"temp.numberplate"}},e._l(e.numberplates,function(t){return a("Option",{key:t.realname,attrs:{value:t.id}},[e._v(e._s(t.realname))])}))],1),e._v(" "),a("FormItem",{attrs:{label:"操作人",prop:"operating"}},[a("Input",{attrs:{placeholder:"操作人"},model:{value:e.temp.operating,callback:function(t){e.$set(e.temp,"operating",t)},expression:"temp.operating"}})],1),e._v(" "),a("FormItem",{attrs:{label:"派量",prop:"oncetraffic"}},[a("InputNumber",{staticStyle:{width:"365px"},attrs:{max:1e3,min:1},model:{value:e.temp.oncetraffic,callback:function(t){e.$set(e.temp,"oncetraffic",t)},expression:"temp.oncetraffic"}})],1),e._v(" "),a("FormItem",{attrs:{label:"派单时间",prop:"time"}},[a("DatePicker",{staticStyle:{width:"370px"},attrs:{type:"datetime",placeholder:"请选择时间"},model:{value:e.temp.createtime,callback:function(t){e.$set(e.temp,"createtime",t)},expression:"temp.createtime"}})],1),e._v(" "),a("FormItem",[a("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between"}},[a("Button",{staticClass:"button",attrs:{size:"large",type:"success"},on:{click:e.right}},[e._v("确定")]),e._v(" "),a("Button",{staticClass:"button",attrs:{size:"large",type:"info"},on:{click:e.cancel}},[e._v("取消")])],1)])],1)],1),e._v(" "),a("Modal",{attrs:{width:"800","class-name":"vertical-center-modal",scrollable:!0},model:{value:e.deleteStatus,callback:function(t){e.deleteStatus=t},expression:"deleteStatus"}},[a("Table",{staticStyle:{"margin-top":"30px"},attrs:{data:e.detailsDatas,columns:e.detailsTitles,width:"780px"}}),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(s,l,!1,function(e){a("rDJH")},"data-v-7873158f",null);t.default=d.exports},SVfk:function(e,t){},rDJH:function(e,t){}});