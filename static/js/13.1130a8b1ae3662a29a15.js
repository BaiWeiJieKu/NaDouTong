webpackJsonp([13],{Hswi:function(e,t){},TXEG:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aozt"),i=a.n(r),n={name:"driverManagementSearch",data:function(){return{formItem:{realname:"",tel:"",idcard:"",cid:"",numberplate:"",start:"",end:new Date,page:1},formRule:{},data:[]}},methods:{handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?t.$emit("handleOptionsSearch",t.formItem):t.$Message.error("请填写必填字段")})}},props:{captions:Array}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("Form",{ref:"formItem",attrs:{model:e.formItem,rules:e.formRule,"label-position":"left","label-width":60,inline:""}},[a("FormItem",{attrs:{label:"真实名称",prop:"realname"}},[a("Input",{attrs:{placeholder:"真实名称"},model:{value:e.formItem.realname,callback:function(t){e.$set(e.formItem,"realname",t)},expression:"formItem.realname"}})],1),e._v(" "),a("FormItem",{attrs:{label:"手机号",prop:"tel"}},[a("Input",{attrs:{placeholder:"手机号"},model:{value:e.formItem.tel,callback:function(t){e.$set(e.formItem,"tel",t)},expression:"formItem.tel"}})],1),e._v(" "),a("FormItem",{attrs:{label:"身份证号",prop:"idcard"}},[a("Input",{attrs:{placeholder:"身份证号"},model:{value:e.formItem.idcard,callback:function(t){e.$set(e.formItem,"idcard",t)},expression:"formItem.idcard"}})],1),e._v(" "),a("FormItem",{attrs:{label:"车队名称",prop:"cid"}},[a("Select",{attrs:{filterable:"",clearable:""},model:{value:e.formItem.cid,callback:function(t){e.$set(e.formItem,"cid",t)},expression:"formItem.cid"}},e._l(e.captions,function(t){return a("Option",{key:t.fleetname,attrs:{value:t.id}},[e._v(e._s(t.fleetname))])}))],1),e._v(" "),a("FormItem",{attrs:{label:"车牌号",prop:"numberplate"}},[a("Input",{attrs:{placeholder:"车牌号"},model:{value:e.formItem.numberplate,callback:function(t){e.$set(e.formItem,"numberplate",t)},expression:"formItem.numberplate"}})],1),e._v(" "),a("br"),e._v(" "),a("FormItem",{attrs:{label:"创建时间",prop:"start"}},[a("DatePicker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"请选择时间"},model:{value:e.formItem.start,callback:function(t){e.$set(e.formItem,"start",t)},expression:"formItem.start"}})],1),e._v(" "),a("FormItem",{attrs:{label:"~",prop:"end","label-width":30}},[a("DatePicker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"请选择时间"},model:{value:e.formItem.end,callback:function(t){e.$set(e.formItem,"end",t)},expression:"formItem.end"}})],1),e._v(" "),a("FormItem",{staticStyle:{"margin-left":"-60px"}},[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("formItem")}}},[e._v("查询")])],1)],1)],1)},staticRenderFns:[]};var l={name:"driverManagement",data:function(){var e=this,t=function(e,t,a){""===t?a(new Error("请选择车辆")):""!=t&&a()};return{otherStatus:!1,tempDriver:{carid:"",id:""},drivers:[],ruleValidate:{realname:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],idcard:[{required:!0,validator:function(e,t,a){""===t?a(new Error("身份证号不可以为空")):/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)?a():a(new Error("请输入正确的身份证号"))},trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"change"}],tel:[{required:!0,validator:function(e,t,a){""===t?a(new Error("联系方式不可以为空")):/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/.test(t)?a():a(new Error("联系方式格式不正确"))},trigger:"blur"}],cid:[{required:!0,validator:function(e,t,a){""===t?a(new Error("请选择车队")):""!=t&&a()},trigger:"change"}],carid:[{required:!0,validator:t,trigger:"change"}]},modalValidate:{carid:[{required:!0,validator:t,trigger:"change"}]},showAdd:!0,deleteStatus:!1,query:{},datas:[],href:"",dataId:"",dataTotal:0,searchItems:{},loading:!1,status:!1,captions:[],temp:{id:"",sex:"",realname:"",tel:"",idcard:"",address:"",cid:"",mark:""},titles:[{type:"selection",align:"center",width:50,fixed:"left"},{title:"序号",key:"sequence",width:70,fixed:"left",align:"center",render:function(e,t){return e("div",[e("span",{props:{type:"primary",size:"small"},style:{marginRight:"5px"}},t.index+1)])}},{title:"真实姓名",key:"realname",align:"center",width:110,fixed:"left"},{title:"性别",key:"sex",align:"center",width:130},{title:"手机号码",key:"tel",align:"center",width:130},{title:"身份证号",key:"idcard",align:"center",width:180},{title:"地址",key:"address",align:"center",width:270},{title:"车牌号",key:"numberplate",align:"center",width:220},{title:"创建时间",key:"createtime",align:"center",width:180},{title:"人车照片",key:"pcphoto",align:"center",width:180,render:function(t,a){if(""==a.row.pcphoto){var r=e;return t("Upload",{props:{action:"/uploadPcphoto?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){r.handleSearch(r.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])}var i=e;return t("div",[t("a",{attrs:{href:a.row.pcphoto,target:"_blank"}},"查看图片"),t("Upload",{style:{display:"inline"},props:{action:"/uploadPcphoto?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){i.handleSearch(i.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])])}},{title:"身份证正面",key:"idcarda",align:"center",width:180,render:function(t,a){if(""==a.row.idcarda){var r=e;return t("Upload",{props:{action:"/uploadIdcardA?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){r.handleSearch(r.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])}var i=e;return t("div",[t("a",{attrs:{href:a.row.idcarda,target:"_blank"}},"查看图片"),t("Upload",{style:{display:"inline"},props:{action:"/uploadIdcardA?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){i.handleSearch(i.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])])}},{title:"身份证反面",key:"idcardb",align:"center",width:180,render:function(t,a){if(""==a.row.idcardb){var r=e;return t("Upload",{props:{action:"/uploadIdcardB?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){r.handleSearch(r.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])}var i=e;return t("div",[t("a",{attrs:{href:a.row.idcardb,target:"_blank"}},"查看图片"),t("Upload",{style:{display:"inline"},props:{action:"/uploadIdcardB?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){i.handleSearch(i.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])])}},{title:"驾驶证照片",key:"drivercard",align:"center",width:180,render:function(t,a){if(""==a.row.drivercard){var r=e;return t("Upload",{props:{action:"/uploadDriverCard?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){r.handleSearch(r.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])}var i=e;return t("div",[t("a",{attrs:{href:a.row.drivercard,target:"_blank"}},"查看图片"),t("Upload",{style:{display:"inline"},props:{action:"/uploadDriverCard?id="+a.row.id,accept:"image/*","show-upload-list":!1,onSuccess:function(){i.handleSearch(i.query)}}},[t("Button",{props:{icon:"ios-cloud-upload"}})])])}},{title:"车队名称",key:"cid",align:"center",width:180,render:function(t,a){return t("div",e.captions.find(function(e){return e.id===a.row.cid}).fleetname)}},{title:"备注",key:"mark",align:"center",width:220},{title:"编辑",key:"id",width:250,fixed:"right",align:"center",render:function(t,a){var r="添加车辆";return a.row.numberplate&&(r="修改车辆"),t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.dataIndex=a.row.id,e.handlerOtherModal(a.row)}}},r),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.dataIndex=a.row.id,e.show(a.row)}}},"修改"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteStatus=!0,e.dataId=a.row.id}}},"删除")])}}]}},components:{driverManagementSearch:a("C7Lr")(n,o,!1,function(e){a("Hswi")},"data-v-11d17d02",null).exports,Table:a("8Wy1").a},methods:{handlerOtherModal:function(e){console.log(this.drivers),this.tempDriver.id=e.id,this.otherStatus=!0},otherRight:function(){var e=this;this.$refs.tempDriver.validate(function(t){t&&(e.otherStatus=!1,i.a.get("/api/updateDriverCar.json",{params:e.tempDriver}).then(e.otherRightSucc))})},otherRightSucc:function(e){(e=e.data).ret&&this.handleSearch(this.query)},othercancel:function(){this.tempDriver.carid="",this.otherStatus=!1},driversInit:function(){i.a.get("/api/getAllCars.json").then(this.driversInitSucc)},driversInitSucc:function(e){(e=e.data).ret&&(this.drivers=e.data)},handleSearch:function(e){this.query=e,this.loading=!0,i.a.get("/api/driverManagement.json",{params:e}).then(this.getOptionsSucc)},getOptionsSucc:function(e){this.loading=!1,(e=e.data).ret&&e.data&&(this.datas=e.data.data,this.dataTotal=e.data.total)},deleteSucc:function(){this.handleSearch(this.query)},pageChange:function(e){this.query.page=e,this.handleSearch(this.query)},handleInsert:function(){this.clearModel(),this.status=!0,this.href="/api/insertDriverManagement.json"},right:function(){var e=this;this.$refs.temp.validate(function(t){t&&(e.loading=!0,i.a.get(e.href,{params:e.temp}).then(e.insertSucc))})},cancel:function(){this.$refs.temp.resetFields(),this.status=!1},otherCancel:function(e){e||this.cancel()},insertSucc:function(e){e=e.data,this.loading=!1,e.ret&&this.handleSearch(this.query),this.status=!1},clearModel:function(){for(var e in this.temp)this.temp[e]=""},handleDelete:function(e){i.a.get("/api/deleteDriverManagement.json",{params:{ids:this.dataId}}).then(this.handleDeleteSucc)},handleDeleteSucc:function(e){this.deleteStatus=!1,(e=e.data).ret?this.handleSearch(this.query):this.$Notice.error({desc:"删除失败",duration:0})},deleteAll:function(e){i.a.get("/api/deleteDriverManagement.json",{params:{ids:e.toString()}}).then(this.handleDeleteSucc)},show:function(e){this.status=!0,this.temp.id=e.id,this.temp.sex=e.sex,this.temp.realname=e.realname,this.temp.tel=e.tel,this.temp.idcard=e.idcard,this.temp.address=e.address,this.temp.cid=e.cid,this.temp.mark=e.mark,this.href="/api/updeteDriverManagement.json"},handleTeam:function(){i.a.get("/api/driverTeam.json").then(this.headleTeamSucc)},headleTeamSucc:function(e){(e=e.data).ret&&(this.captions=e.data)}},mounted:function(){this.handleTeam(),this.driversInit()}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("driverManagementSearch",{attrs:{captions:e.captions},on:{handleOptionsSearch:e.handleSearch}}),e._v(" "),a("Table",{attrs:{page:e.query.page,titles:e.titles,datas:e.datas,total:e.dataTotal,loading:e.loading,show:e.showAdd},on:{handleInsert:e.handleInsert,deleteAll:e.deleteAll,pageChange:e.pageChange}}),e._v(" "),a("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,"ok-text":"确定","cancel-text":"取消",width:"500",styles:{top:"20px"}},on:{"on-visible-change":e.otherCancel},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("Form",{ref:"temp",staticStyle:{"margin-top":"20px"},attrs:{rules:e.ruleValidate,model:e.temp,"label-width":100}},[a("FormItem",{attrs:{label:"真实姓名",prop:"realname"}},[a("Input",{attrs:{placeholder:"真实姓名"},model:{value:e.temp.realname,callback:function(t){e.$set(e.temp,"realname",t)},expression:"temp.realname"}})],1),e._v(" "),a("FormItem",{attrs:{label:"身份证号",prop:"idcard"}},[a("Input",{attrs:{placeholder:"身份证号"},model:{value:e.temp.idcard,callback:function(t){e.$set(e.temp,"idcard",t)},expression:"temp.idcard"}})],1),e._v(" "),a("FormItem",{attrs:{label:"地址",prop:"address"}},[a("Input",{attrs:{placeholder:"地址"},model:{value:e.temp.address,callback:function(t){e.$set(e.temp,"address",t)},expression:"temp.address"}})],1),e._v(" "),a("FormItem",{attrs:{label:"性别",prop:"sex"}},[a("Select",{model:{value:e.temp.sex,callback:function(t){e.$set(e.temp,"sex",t)},expression:"temp.sex"}},[a("Option",{attrs:{value:"男"}},[e._v("男")]),e._v(" "),a("Option",{attrs:{value:"女"}},[e._v("女")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"手机号",prop:"tel"}},[a("Input",{attrs:{placeholder:"手机号"},model:{value:e.temp.tel,callback:function(t){e.$set(e.temp,"tel",t)},expression:"temp.tel"}})],1),e._v(" "),a("FormItem",{attrs:{label:"车队名称",prop:"cid"}},[a("Select",{attrs:{filterable:""},model:{value:e.temp.cid,callback:function(t){e.$set(e.temp,"cid",t)},expression:"temp.cid"}},e._l(e.captions,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.fleetname))])}))],1),e._v(" "),a("FormItem",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"备注"},model:{value:e.temp.mark,callback:function(t){e.$set(e.temp,"mark",t)},expression:"temp.mark"}})],1),e._v(" "),a("FormItem",[a("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between"}},[a("Button",{staticClass:"button",attrs:{size:"large",type:"success"},on:{click:e.right}},[e._v("确定")]),e._v(" "),a("Button",{staticClass:"button",attrs:{size:"large",type:"info"},on:{click:e.cancel}},[e._v("取消")])],1)])],1)],1),e._v(" "),a("Modal",{attrs:{"ok-text":"删除","cancel-text":"取消","class-name":"vertical-center-modal"},on:{"on-ok":e.handleDelete},model:{value:e.deleteStatus,callback:function(t){e.deleteStatus=t},expression:"deleteStatus"}},[a("p",[e._v("确定删除吗")])]),e._v(" "),a("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,width:"500",styles:{top:"20px"}},model:{value:e.otherStatus,callback:function(t){e.otherStatus=t},expression:"otherStatus"}},[a("Form",{ref:"tempDriver",staticStyle:{"margin-top":"20px"},attrs:{rules:e.modalValidate,model:e.tempDriver,"label-width":100}},[a("FormItem",{attrs:{label:"车辆",prop:"carid"}},[a("Select",{staticStyle:{width:"350px"},attrs:{clearable:"",filterable:""},model:{value:e.tempDriver.carid,callback:function(t){e.$set(e.tempDriver,"carid",t)},expression:"tempDriver.carid"}},e._l(e.drivers,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.numberplate))])}))],1),e._v(" "),a("FormItem",[a("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between"}},[a("Button",{staticClass:"button",attrs:{size:"large",type:"success"},on:{click:e.otherRight}},[e._v("确定")]),e._v(" "),a("Button",{staticClass:"button",attrs:{size:"large",type:"info"},on:{click:e.othercancel}},[e._v("取消")])],1)])],1)],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(l,s,!1,function(e){a("yNIh")},"data-v-7d2bb380",null);t.default=d.exports},yNIh:function(e,t){}});